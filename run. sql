-- Функція, що видаляє з таблиці Issue усі випуски, що не мали ілюстратора.
DROP FUNCTION IF EXISTS clean_cov();
CREATE OR REPLACE FUNCTION clean_cov() RETURNS void
LANGUAGE plpgsql
AS $$
BEGIN 
   DELETE FROM issue
   WHERE issue.authors_id IN 
      (SELECT issue.authors_id from issue left join authors using(authors_id) where authors.cover_artist is NULL);
END;
$$; 
select clean_cov();
select * from issue

--Процедура, що виводить надає інформацію про комікс з вказаним рейтингом
DROP PROCEDURE IF EXISTS get_cname(varchar(20));
CREATE OR REPLACE PROCEDURE get_cname(rate_arg varchar(50))
LANGUAGE 'plpgsql'
AS $$
DECLARE record_cname info.comic_name%TYPE;
DECLARE record_rate info.rating%TYPE;

BEGIN
    SELECT comic_name, rating into record_cname, record_rate FROM info WHERE rating = rate_arg;
    RAISE INFO 'Comic_name: %,  Rating: %', TRIM(record_cname), TRIM(record_rate);
END;
$$;


select * from info
CALL get_cname('Rated T');
